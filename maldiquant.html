<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 MALDIquant | _main.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="3 MALDIquant | _main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 MALDIquant | _main.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="cv.html"/>
<link rel="next" href="open-peer-review.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introductie</a></li>
<li class="chapter" data-level="2" data-path="cv.html"><a href="cv.html"><i class="fa fa-check"></i><b>2</b> CV</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cv.html"><a href="cv.html#education"><i class="fa fa-check"></i><b>2.1</b> Education</a></li>
<li class="chapter" data-level="2.2" data-path="cv.html"><a href="cv.html#important-courses"><i class="fa fa-check"></i><b>2.2</b> Important Courses</a></li>
<li class="chapter" data-level="2.3" data-path="cv.html"><a href="cv.html#projects"><i class="fa fa-check"></i><b>2.3</b> Projects</a></li>
<li class="chapter" data-level="2.4" data-path="cv.html"><a href="cv.html#minor-data-science-for-biology"><i class="fa fa-check"></i><b>2.4</b> Minor Data science for Biology</a></li>
<li class="chapter" data-level="2.5" data-path="cv.html"><a href="cv.html#important-skills"><i class="fa fa-check"></i><b>2.5</b> Important Skills</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="maldiquant.html"><a href="maldiquant.html"><i class="fa fa-check"></i><b>3</b> MALDIquant</a>
<ul>
<li class="chapter" data-level="3.1" data-path="maldiquant.html"><a href="maldiquant.html#intro"><i class="fa fa-check"></i><b>3.1</b> Intro</a></li>
<li class="chapter" data-level="3.2" data-path="maldiquant.html"><a href="maldiquant.html#start"><i class="fa fa-check"></i><b>3.2</b> start</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="open-peer-review.html"><a href="open-peer-review.html"><i class="fa fa-check"></i><b>4</b> Open Peer Review</a>
<ul>
<li class="chapter" data-level="4.1" data-path="open-peer-review.html"><a href="open-peer-review.html#article"><i class="fa fa-check"></i><b>4.1</b> Article</a></li>
<li class="chapter" data-level="4.2" data-path="open-peer-review.html"><a href="open-peer-review.html#summary"><i class="fa fa-check"></i><b>4.2</b> Summary</a></li>
<li class="chapter" data-level="4.3" data-path="open-peer-review.html"><a href="open-peer-review.html#review"><i class="fa fa-check"></i><b>4.3</b> Review</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="datetime-r-package.html"><a href="datetime-r-package.html"><i class="fa fa-check"></i><b>5</b> DateTime R Package</a>
<ul>
<li class="chapter" data-level="5.1" data-path="datetime-r-package.html"><a href="datetime-r-package.html#introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="datetime-r-package.html"><a href="datetime-r-package.html#installation"><i class="fa fa-check"></i><b>5.2</b> Installation</a></li>
<li class="chapter" data-level="5.3" data-path="datetime-r-package.html"><a href="datetime-r-package.html#fuctions-of-the-package"><i class="fa fa-check"></i><b>5.3</b> Fuctions of the package</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="datetime-r-package.html"><a href="datetime-r-package.html#calculating-date-difference"><i class="fa fa-check"></i><b>5.3.1</b> Calculating date difference</a></li>
<li class="chapter" data-level="5.3.2" data-path="datetime-r-package.html"><a href="datetime-r-package.html#add-time-to-a-date"><i class="fa fa-check"></i><b>5.3.2</b> Add time to a date</a></li>
<li class="chapter" data-level="5.3.3" data-path="datetime-r-package.html"><a href="datetime-r-package.html#check-if-two-dates-are-on-the-same-day"><i class="fa fa-check"></i><b>5.3.3</b> Check if two dates are on the same day</a></li>
<li class="chapter" data-level="5.3.4" data-path="datetime-r-package.html"><a href="datetime-r-package.html#check-for-dutch-holidays"><i class="fa fa-check"></i><b>5.3.4</b> Check for Dutch holidays</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="maldiquant" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> MALDIquant<a href="maldiquant.html#maldiquant" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intro" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Intro<a href="maldiquant.html#intro" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Door mijn intresse in bacteriën en virussen heb ik in mijn derde jaar gekozen voor de specialisatie microbiologie. Hierbij moest ik voor een project werken met de bacterie <em>Porphyromonas gingivalis</em>. De bacterie werd hierbij blootgesteld aan verschillende concentraties magnesium en ijzer. Om het effect hiervan te meten op het aantal uitgescheiden outer membrane vesicles (OMV’s), werd er gebruik gemaakt van een fluorescentie microscoop en MALDI-TOF MS.</p>
<p>Voor MALDI-TOF MS data bestaat er een package genaamd MALDIquant, met een complete pipeline voor analyse. Omdat ik de MALDI-TOF MS een interessante techniek vind in de microbiologie, lijkt het me leuk om uit te zoeken hoe deze package werkt.
Door op internet informatie te vinden over de package zou ik deze willen toepassen op mijn vorige project om de resultaten die ik toen had en nu heb te vergelijken. Hiermee zou ik in 4 dagen mee kunnen beginnen.</p>
<p>De eerste twee dagen zal ik vooral oefenen met het gebruik van de package. Op internet zijn er verschillende manuals te vinden en die zou ik kunnen doorlopen met fake-data. Vervolgens kan ik proberen of ik de package kan laten runnen op mijn eigen data.</p>
</div>
<div id="start" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> start<a href="maldiquant.html#start" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="maldiquant.html#cb1-1" tabindex="-1"></a><span class="co"># Installeer de juiste packages </span></span>
<span id="cb1-2"><a href="maldiquant.html#cb1-2" tabindex="-1"></a><span class="co"># install.packages(c(&quot;MALDIquant&quot;, &quot;MALDIquantForeign&quot;))</span></span>
<span id="cb1-3"><a href="maldiquant.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(MALDIquant)</span></code></pre></div>
<pre><code>## 
## This is MALDIquant version 1.22.2
## Quantitative Analysis of Mass Spectrometry Data
##  See &#39;?MALDIquant&#39; for more information about this package.</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="maldiquant.html#cb3-1" tabindex="-1"></a><span class="co"># MALDIquant objects </span></span>
<span id="cb3-2"><a href="maldiquant.html#cb3-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">createMassSpectrum</span>(<span class="at">mass=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">intensity=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb3-3"><a href="maldiquant.html#cb3-3" tabindex="-1"></a>                        <span class="at">metaData=</span><span class="fu">list</span>(<span class="at">name=</span><span class="st">&quot;Spectrum1&quot;</span>))</span>
<span id="cb3-4"><a href="maldiquant.html#cb3-4" tabindex="-1"></a>s</span></code></pre></div>
<pre><code>## S4 class type            : MassSpectrum
## Number of m/z values     : 10          
## Range of m/z values      : 1 - 10      
## Range of intensity values: 1 - 10      
## Memory usage             : 1.414 KiB   
## Name                     : Spectrum1</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="maldiquant.html#cb5-1" tabindex="-1"></a><span class="co"># importeer voorbeeld data </span></span>
<span id="cb5-2"><a href="maldiquant.html#cb5-2" tabindex="-1"></a><span class="co"># subset van MALDI-TOF data van Fiedler et al(2009)</span></span>
<span id="cb5-3"><a href="maldiquant.html#cb5-3" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;fiedler2009subset&quot;</span>)</span>
<span id="cb5-4"><a href="maldiquant.html#cb5-4" tabindex="-1"></a><span class="fu">length</span>(fiedler2009subset)</span></code></pre></div>
<pre><code>## [1] 16</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="maldiquant.html#cb7-1" tabindex="-1"></a>fiedler2009subset[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code></pre></div>
<pre><code>## $sPankreas_HB_L_061019_G10.M19.T_0209513_0020740_18
## S4 class type            : MassSpectrum                
## Number of m/z values     : 42388                       
## Range of m/z values      : 1000.015 - 9999.734         
## Range of intensity values: 5 - 101840                  
## Memory usage             : 506.359 KiB                 
## Name                     : Pankreas_HB_L_061019_G10.M19
## File                     : /data/set A - discovery leipzig/control/Pankreas_HB_L_061019_G10/0_m19/1/1SLin/fid
## 
## $sPankreas_HB_L_061019_G10.M20.T_0209513_0020740_18
## S4 class type            : MassSpectrum                
## Number of m/z values     : 42388                       
## Range of m/z values      : 1000.015 - 9999.734         
## Range of intensity values: 6 - 111862                  
## Memory usage             : 506.359 KiB                 
## Name                     : Pankreas_HB_L_061019_G10.M20
## File                     : /data/set A - discovery leipzig/control/Pankreas_HB_L_061019_G10/0_m20/1/1SLin/fid</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="maldiquant.html#cb9-1" tabindex="-1"></a><span class="co"># quality control: alle spectra hetzelfde aantal data punten die niet leeg zijn</span></span>
<span id="cb9-2"><a href="maldiquant.html#cb9-2" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">sapply</span>(fiedler2009subset, isEmpty))</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="maldiquant.html#cb11-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">sapply</span>(fiedler2009subset, length))</span></code></pre></div>
<pre><code>## 
## 42388 
##    16</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="maldiquant.html#cb13-1" tabindex="-1"></a><span class="fu">all</span>(<span class="fu">sapply</span>(fiedler2009subset, isRegular))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="maldiquant.html#cb15-1" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb15-2"><a href="maldiquant.html#cb15-2" tabindex="-1"></a><span class="fu">plot</span>(fiedler2009subset[[<span class="dv">1</span>]])</span></code></pre></div>
<p><img src="_main_files/figure-html/Vignettte-1.png" width="672" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="maldiquant.html#cb16-1" tabindex="-1"></a><span class="fu">plot</span>(fiedler2009subset[[<span class="dv">16</span>]])</span></code></pre></div>
<p><img src="_main_files/figure-html/Vignettte-2.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="maldiquant.html#cb17-1" tabindex="-1"></a>fiedler2009subset[<span class="dv">16</span>]</span></code></pre></div>
<pre><code>## $sPankreas_HB_L_061019_D9.G18.T_0209513_0020740_18
## S4 class type            : MassSpectrum               
## Number of m/z values     : 42388                      
## Range of m/z values      : 1000.015 - 9999.734        
## Range of intensity values: 7 - 22786                  
## Memory usage             : 506.367 KiB                
## Name                     : Pankreas_HB_L_061019_D9.G18
## File                     : /data/set B - discovery heidelberg/tumor/Pankreas_HB_L_061019_D9/0_g18/1/1SLin/fid</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="maldiquant.html#cb19-1" tabindex="-1"></a><span class="co"># variance stabilization </span></span>
<span id="cb19-2"><a href="maldiquant.html#cb19-2" tabindex="-1"></a>spectra <span class="ot">&lt;-</span> <span class="fu">transformIntensity</span>(fiedler2009subset,</span>
<span id="cb19-3"><a href="maldiquant.html#cb19-3" tabindex="-1"></a>                              <span class="at">method =</span> <span class="st">&quot;sqrt&quot;</span>)</span>
<span id="cb19-4"><a href="maldiquant.html#cb19-4" tabindex="-1"></a><span class="co"># smoothing </span></span>
<span id="cb19-5"><a href="maldiquant.html#cb19-5" tabindex="-1"></a>spectra <span class="ot">&lt;-</span> <span class="fu">smoothIntensity</span>(spectra, <span class="at">method=</span><span class="st">&quot;SavitzkyGolay&quot;</span>,</span>
<span id="cb19-6"><a href="maldiquant.html#cb19-6" tabindex="-1"></a>                           <span class="at">halfWindowSize=</span><span class="dv">10</span>)</span>
<span id="cb19-7"><a href="maldiquant.html#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="maldiquant.html#cb19-8" tabindex="-1"></a><span class="co"># baseline correction</span></span>
<span id="cb19-9"><a href="maldiquant.html#cb19-9" tabindex="-1"></a>baseline <span class="ot">&lt;-</span> <span class="fu">estimateBaseline</span>(spectra[[<span class="dv">16</span>]], <span class="at">method=</span><span class="st">&quot;SNIP&quot;</span>,</span>
<span id="cb19-10"><a href="maldiquant.html#cb19-10" tabindex="-1"></a>                              <span class="at">iterations=</span><span class="dv">100</span>)</span>
<span id="cb19-11"><a href="maldiquant.html#cb19-11" tabindex="-1"></a><span class="fu">plot</span>(spectra[[<span class="dv">16</span>]])</span>
<span id="cb19-12"><a href="maldiquant.html#cb19-12" tabindex="-1"></a><span class="fu">lines</span>(baseline, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Vignettte-3.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="maldiquant.html#cb20-1" tabindex="-1"></a>spectra <span class="ot">&lt;-</span> <span class="fu">removeBaseline</span>(spectra, <span class="at">method=</span><span class="st">&quot;SNIP&quot;</span>,</span>
<span id="cb20-2"><a href="maldiquant.html#cb20-2" tabindex="-1"></a>                           <span class="at">iterations=</span><span class="dv">100</span>)</span>
<span id="cb20-3"><a href="maldiquant.html#cb20-3" tabindex="-1"></a><span class="fu">plot</span>(spectra[[<span class="dv">1</span>]])</span></code></pre></div>
<p><img src="_main_files/figure-html/Vignettte-4.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="maldiquant.html#cb21-1" tabindex="-1"></a><span class="co"># normalisatie </span></span>
<span id="cb21-2"><a href="maldiquant.html#cb21-2" tabindex="-1"></a>spectra <span class="ot">&lt;-</span> <span class="fu">calibrateIntensity</span>(spectra, <span class="at">method=</span><span class="st">&quot;TIC&quot;</span>)</span>
<span id="cb21-3"><a href="maldiquant.html#cb21-3" tabindex="-1"></a></span>
<span id="cb21-4"><a href="maldiquant.html#cb21-4" tabindex="-1"></a><span class="co"># alignment </span></span>
<span id="cb21-5"><a href="maldiquant.html#cb21-5" tabindex="-1"></a>spectra <span class="ot">&lt;-</span> <span class="fu">alignSpectra</span>(spectra,</span>
<span id="cb21-6"><a href="maldiquant.html#cb21-6" tabindex="-1"></a>                        <span class="at">halfWindowSize=</span><span class="dv">20</span>,</span>
<span id="cb21-7"><a href="maldiquant.html#cb21-7" tabindex="-1"></a>                        <span class="at">SNR=</span><span class="dv">2</span>,</span>
<span id="cb21-8"><a href="maldiquant.html#cb21-8" tabindex="-1"></a>                        <span class="at">tolerance=</span><span class="fl">0.002</span>,</span>
<span id="cb21-9"><a href="maldiquant.html#cb21-9" tabindex="-1"></a>                        <span class="at">warpingMethod=</span><span class="st">&quot;lowess&quot;</span>)</span>
<span id="cb21-10"><a href="maldiquant.html#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="maldiquant.html#cb21-11" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">sapply</span>(spectra,</span>
<span id="cb21-12"><a href="maldiquant.html#cb21-12" tabindex="-1"></a>                          <span class="cf">function</span>(x)<span class="fu">metaData</span>(x)<span class="sc">$</span>sampleName))</span>
<span id="cb21-13"><a href="maldiquant.html#cb21-13" tabindex="-1"></a></span>
<span id="cb21-14"><a href="maldiquant.html#cb21-14" tabindex="-1"></a>avgSpectra <span class="ot">&lt;-</span> <span class="fu">averageMassSpectra</span>(spectra, <span class="at">labels=</span>samples,</span>
<span id="cb21-15"><a href="maldiquant.html#cb21-15" tabindex="-1"></a>                                  <span class="at">method=</span><span class="st">&quot;mean&quot;</span>)</span>
<span id="cb21-16"><a href="maldiquant.html#cb21-16" tabindex="-1"></a></span>
<span id="cb21-17"><a href="maldiquant.html#cb21-17" tabindex="-1"></a><span class="co"># Peak detectie </span></span>
<span id="cb21-18"><a href="maldiquant.html#cb21-18" tabindex="-1"></a>noise <span class="ot">&lt;-</span> <span class="fu">estimateNoise</span>(avgSpectra[[<span class="dv">1</span>]])</span>
<span id="cb21-19"><a href="maldiquant.html#cb21-19" tabindex="-1"></a> <span class="fu">plot</span>(avgSpectra[[<span class="dv">1</span>]], <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">5000</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.002</span>))</span>
<span id="cb21-20"><a href="maldiquant.html#cb21-20" tabindex="-1"></a> <span class="fu">lines</span>(noise, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb21-21"><a href="maldiquant.html#cb21-21" tabindex="-1"></a> <span class="fu">lines</span>(noise[,<span class="dv">1</span>], noise[, <span class="dv">2</span>]<span class="sc">*</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Vignettte-5.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="maldiquant.html#cb22-1" tabindex="-1"></a>peaks <span class="ot">&lt;-</span> <span class="fu">detectPeaks</span>(avgSpectra, <span class="at">method=</span><span class="st">&quot;MAD&quot;</span>,</span>
<span id="cb22-2"><a href="maldiquant.html#cb22-2" tabindex="-1"></a>                       <span class="at">halfWindowSize=</span><span class="dv">20</span>, <span class="at">SNR=</span><span class="dv">2</span>)</span>
<span id="cb22-3"><a href="maldiquant.html#cb22-3" tabindex="-1"></a><span class="fu">plot</span>(avgSpectra[[<span class="dv">1</span>]], <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">4000</span>, <span class="dv">5000</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.002</span>))</span>
<span id="cb22-4"><a href="maldiquant.html#cb22-4" tabindex="-1"></a><span class="fu">points</span>(peaks[[<span class="dv">1</span>]], <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/Vignettte-6.png" width="672" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="maldiquant.html#cb23-1" tabindex="-1"></a><span class="co"># peak binning  </span></span>
<span id="cb23-2"><a href="maldiquant.html#cb23-2" tabindex="-1"></a>peaks <span class="ot">&lt;-</span> <span class="fu">binPeaks</span>(peaks, <span class="at">tolerance=</span><span class="fl">0.002</span>)</span>
<span id="cb23-3"><a href="maldiquant.html#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="maldiquant.html#cb23-4" tabindex="-1"></a><span class="co"># feature matrix </span></span>
<span id="cb23-5"><a href="maldiquant.html#cb23-5" tabindex="-1"></a>peaks <span class="ot">&lt;-</span> <span class="fu">filterPeaks</span>(peaks, <span class="at">minFrequency=</span><span class="fl">0.25</span>)</span>
<span id="cb23-6"><a href="maldiquant.html#cb23-6" tabindex="-1"></a>featureMatrix <span class="ot">&lt;-</span> <span class="fu">intensityMatrix</span>(peaks, avgSpectra)</span>
<span id="cb23-7"><a href="maldiquant.html#cb23-7" tabindex="-1"></a><span class="fu">head</span>(featureMatrix[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span></code></pre></div>
<pre><code>##      1011.73182227583 1020.6748082171 1029.40115131151
## [1,]     0.0001894947    0.0007715987     0.0001093035
## [2,]     0.0002144354    0.0015030560     0.0001422394
## [3,]     0.0002117147    0.0004555688     0.0001303326
## [4,]     0.0002314181    0.0005260977     0.0001441254
## [5,]     0.0001562401    0.0024054031     0.0001198008
## [6,]     0.0001600630    0.0020315191     0.0001090484</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="cv.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="open-peer-review.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
